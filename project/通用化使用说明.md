# 通用物品分类系统使用指南

## 🎯 系统通用性说明

本系统基于 **HOG 特征 + SVM 分类器** 的架构，**完全支持**任何物品的分类识别，不仅限于狗品种。核心算法具有通用性，可以应用于：

- **食品分类**：水果、蔬菜、菜品识别
- **工业检测**：零件分类、缺陷检测、产品质检
- **商品识别**：服装、电子产品、家具分类
- **医学影像**：病理切片、X 光片分类
- **其他领域**：车型识别、植物分类、文档分类等

## 📁 数据集准备

### 1. 目录结构设置

将您的数据按以下结构组织：

```
your_project/
├── resource/
│   ├── images/                    # 图片数据集主目录
│   │   ├── [类别1名称]/           # 第一个类别
│   │   │   ├── image_001.jpg
│   │   │   ├── image_002.jpg
│   │   │   └── ...
│   │   ├── [类别2名称]/           # 第二个类别
│   │   │   ├── image_001.jpg
│   │   │   └── ...
│   │   └── [类别N名称]/           # 第N个类别
│   │       └── ...
│   └── annotations/               # 标注文件（可选，提升效果）
│       ├── [类别1名称]/
│       │   ├── image_001.xml
│       │   └── ...
│       └── ...
```

### 2. 图片要求

- **格式**：JPG、PNG、BMP 等常见格式
- **尺寸**：建议 200x200 以上，系统会自动调整
- **数量**：每类别至少 50 张，建议 100-500 张
- **质量**：清晰、光照均匀、目标物体完整

### 3. 标注文件制作（可选但推荐）

创建 XML 标注文件可显著提升识别率：

```xml
<annotation>
    <filename>apple_red_001.jpg</filename>
    <size>
        <width>640</width>
        <height>480</height>
    </size>
    <object>
        <name>main_region</name>        <!-- 主要识别区域 -->
        <bndbox>
            <xmin>120</xmin>
            <ymin>80</ymin>
            <xmax>520</xmax>
            <ymax>400</ymax>
        </bndbox>
    </object>
    <object>
        <name>detail_region</name>      <!-- 细节区域（可选）-->
        <bndbox>
            <xmin>200</xmin>
            <ymin>150</ymin>
            <xmax>350</xmax>
            <ymax>250</ymax>
        </bndbox>
    </object>
</annotation>
```

**标注工具推荐**：

- LabelImg (免费，支持 Pascal VOC 格式)
- CVAT (在线标注工具)
- Labelme (Python 工具)

## ⚙️ 代码配置

### 修改数据路径

编辑 `train.cpp` 中的路径设置：

```cpp
// 修改为您的数据路径
std::string images_dir = "你的项目路径/resource/images";
std::string annotations_dir = "你的项目路径/resource/annotations";
```

编辑 `predict.cpp` 中的测试路径：

```cpp
// 性能测试时的数据路径
std::string images_dir = "你的项目路径/resource/images";
std::string annotations_dir = "你的项目路径/resource/annotations";
```

### 模型文件命名

系统会自动根据您的类别生成：

- `your_model_optimized.xml` - 优化版模型
- `your_model_basic.xml` - 基础版模型
- `*.breeds` - 类别名称列表

## 🚀 实际应用示例

### 示例 1：水果分类系统

```bash
# 数据结构
resource/
├── images/
│   ├── 苹果/          # 100张苹果图片
│   ├── 香蕉/          # 120张香蕉图片
│   ├── 橙子/          # 80张橙子图片
│   └── 葡萄/          # 95张葡萄图片
└── annotations/       # 对应的标注文件

# 训练命令
./train                # 生成水果分类模型

# 预测命令
./predict apple_test.jpg    # 识别测试苹果
```

### 示例 2：工业零件检测

```bash
# 数据结构
resource/
├── images/
│   ├── 螺丝/          # 正常螺丝图片
│   ├── 垫片/          # 正常垫片图片
│   ├── 弹簧/          # 正常弹簧图片
│   └── 缺陷件/        # 有缺陷的零件
└── annotations/

# 使用流程
./train --basic        # 快速训练基础模型
./predict part_001.jpg # 检测零件类型
./predict --test       # 评估整体性能
```

### 示例 3：服装分类系统

```bash
# 数据结构
resource/
├── images/
│   ├── T恤/
│   ├── 牛仔裤/
│   ├── 连衣裙/
│   ├── 外套/
│   └── 运动鞋/

# 专业训练
./train                # 使用所有优化特性
./predict fashion.jpg  # 识别服装类型
```

## 🎛️ 参数调优建议

### 针对不同物品类型的优化策略

**细节丰富的物品（如纺织品、食品）**

- 启用多尺度 HOG 特征
- 增加数据增强的旋转角度
- 重点标注纹理区域

**形状规整的物品（如工业零件）**

- 重点使用轮廓特征
- 减少亮度变化的数据增强
- 标注关键几何区域

**变化较大的物品（如手写文字）**

- 最大化数据增强效果
- 使用更小的 HOG 窗口
- 增加训练样本数量

## 📊 性能优化

### 数据质量检查

```bash
# 检查每类别样本数量
ls -la resource/images/*/  | wc -l

# 验证标注文件完整性
find resource/annotations/ -name "*.xml" | wc -l
```

### 训练效果评估

```bash
# 完整性能测试
./predict --test

# 对比基础版和优化版
./train --basic      # 训练基础版
./predict --test     # 测试基础版性能
./train              # 训练优化版
./predict --test     # 测试优化版性能
```

## 🔧 常见问题解决

### 识别率低怎么办？

1. **增加训练样本** - 每类别至少 100 张
2. **提高图片质量** - 避免模糊、过暗图片
3. **优化标注** - 精确标注关键区域
4. **调整类别** - 合并相似类别，细分差异大的类别

### 训练时间过长？

1. **减少图片尺寸** - 控制在 500x500 以内
2. **使用基础版** - 临时使用 `--basic` 模式
3. **减少类别数** - 先训练主要类别

### 预测结果不稳定？

1. **增加标注文件** - 提供更精确的 ROI 信息
2. **统一图片风格** - 保持光照、角度一致性
3. **扩充边界样本** - 增加易混淆类别的训练数据

## 💡 最佳实践

1. **渐进式训练**：先用少量类别验证效果，再扩展
2. **交叉验证**：使用不同来源的测试数据验证泛化能力
3. **定期更新**：随着新数据积累，定期重新训练模型
4. **文档记录**：记录每次训练的参数和效果，便于复现

通过以上步骤，您可以将本系统轻松适配到任何物品分类任务！
